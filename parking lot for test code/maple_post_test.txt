[tree]
logging_level=INFO
RUN tree=MapleTree(logging_level={tree$logging_level})
[leaf:fmc_1]
host=10.1.101.39
domain=Global
type=fmc
name=fmc_1
leaf_args=leaf_type={leaf:fmc_1$type},name={leaf:fmc_1$name},json_file_path=@model_json_file,FMC_host={leaf:fmc_1$host},FMC_username=@rest_admin_user,FMC_password=@rest_admin_password,FMC_domain={leaf:fmc_1$domain}
RUN leaf={tree$RUN tree}.add_leaf_instance({leaf:fmc_1$leaf_args})
RUN domain_id={leaf:fmc_1$RUN leaf}.get_domain_id(domain={leaf:fmc_1$domain})
[leaf:fmc_1/set_1]
# Change 'enclave_access_policy' to the name of your target access policy
smart_url=policy/accesspolicies/$..items[@.name is 'enclave_access_policy'].id
RUN policy_id={leaf:fmc_1$RUN leaf}.GET_object_id(url={leaf:fmc_1/set_1$smart_url})
post_url=https://{leaf:fmc_1$host}/api/fmc_config/v1/domain/{leaf:fmc_1$RUN domain_id}/policy/accesspolicies/{leaf:fmc_1/set_1$RUN policy_id}/accessrules?bulk=true
RUN post_1={leaf:fmc_1$RUN leaf}.post_csv_template_bulk(url={leaf:fmc_1/set_1$post_url},file_path=results.csv)
